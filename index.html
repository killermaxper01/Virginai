<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<title>VirginAI ‚Äì Intelligent AI Chat Assistant</title>

<meta property="og:image" content="https://virginai.in/og-image.png">

<link rel="icon" href="/favicon.ico" sizes="any">
<link rel="icon" type="image/png" sizes="16x16" href="/favicon-16x16.png">
<link rel="icon" type="image/png" sizes="32x32" href="/favicon-32x32.png">
<link rel="icon" type="image/png" sizes="192x192" href="/android-chrome-192x192.png">
<link rel="icon" type="image/png" sizes="512x512" href="/android-chrome-512x512.png">
<link rel="apple-touch-icon" sizes="180x180" href="/apple-touch-icon.png">
<link rel="manifest" href="/site.webmanifest">
<meta name="theme-color" content="#050505">

<meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">

<meta name="description" content="VirginAI is an AI-powered chat assistant proudly made in India. Get fast, intelligent answers for learning, research, and productivity.">

<meta name="keywords" content="VirginAI, Virgin AI chatbot, AI chat assistant, AI chatbot India, artificial intelligence chatbot, AI for students, AI study assistant, AI learning assistant, free AI chatbot online, AI question answering, AI productivity tool, secure AI assistant, Navodaya, Navodaya Vidyalaya, Navodayan AI, JNV, Jawahar Navodaya Vidyalay">

<meta name="author" content="VirginAI Developer">
<meta name="robots" content="index, follow">

<meta property="og:title" content="VirginAI - Intelligent AI Chat Assistant">
<meta property="og:description" content="Ask questions, get smart AI answers instantly. Powered by VirginAI.">
<meta property="og:image" content="https://virginai.in/og-image.png">
<meta property="og:url" content="https://virginai.in">
<meta property="og:type" content="website">
<meta property="og:site_name" content="VirginAI">

<meta name="twitter:card" content="summary_large_image">
<meta name="twitter:title" content="VirginAI - Intelligent AI Chat Assistant">
<meta name="twitter:description" content="Ask questions, get smart AI answers instantly.">
<meta name="twitter:image" content="https://virginai.in/og-image.png">
<meta name="twitter:site" content="@virginai">

<script type="application/ld+json">
{
  "@context": "https://schema.org",
  "@type": "WebSite",
  "name": "VirginAI",
  "url": "https://virginai.in/"
}
</script>


<script type="application/ld+json">
{
  "@context": "https://schema.org",
  "@type": "Organization",
  "name": "VirginAI",
  "url": "https://virginai.in/",
  "logo": "https://virginai.in/android-chrome-512x512.png",
  "sameAs": [
    "https://instagram.com/virginai.in",
    "https://github.com/killermaxper01/Virginai"
  ]
}
</script>


<script type="application/ld+json">
{
  "@context": "https://schema.org",
  "@type": "SoftwareApplication",
  "name": "VirginAI",
  "alternateName": "Virgin AI Chat Assistant",
  "url": "https://virginai.in",
  "description": "VirginAI is an Indian AI-powered chat assistant developed by Raj Verma and Kalash Verma. It focuses on education, research, productivity, and intelligent problem-solving. VirginAI is a digital AI platform and is not associated with the U.S. state of Virginia.",
  "applicationCategory": "Artificial Intelligence",
  "operatingSystem": "Web",
  "countryOfOrigin": {
    "@type": "Country",
    "name": "India"
  },
  "creator": [
    {
      "@type": "Person",
      "name": "Raj Verma",
      "nationality": "Indian"
    },
    {
      "@type": "Person",
      "name": "Kalash Verma",
      "nationality": "Indian"
    }
  ],
  "founder": [
    {
      "@type": "Person",
      "name": "Raj Verma"
    },
    {
      "@type": "Person",
      "name": "Kalash Verma"
    }
  ],
  "publisher": {
    "@type": "Organization",
    "name": "VirginAI",
    "logo": {
      "@type": "ImageObject",
      "url": "https://virginai.in/android-chrome-512x512.png"
    },
    "address": {
      "@type": "PostalAddress",
      "addressCountry": "India"
    }
  },
  "offers": {
    "@type": "Offer",
    "price": "0",
    "priceCurrency": "USD"
  },
  "contactPoint": {
    "@type": "ContactPoint",
    "contactType": "Customer Support",
    "url": "https://instagram.com/virginai.in"
  },
  "sameAs": [
    "https://instagram.com/virginai.in",
    "https://github.com/killermaxper01/Virginai"
  ],
  "disambiguatingDescription": "VirginAI is an independent artificial intelligence platform developed in India and is not related to the U.S. state of Virginia."
}
</script>

<script type="application/ld+json">
{
  "@context": "https://schema.org",
  "@type": "SoftwareApplication",
  "name": "VirginAI Image Generator",
  "applicationCategory": "MultimediaApplication",
  "operatingSystem": "Web",
  "description": "VirginAI provides AI-powered text-to-image generation allowing users to create realistic and artistic images using natural language prompts.",
  "featureList": [
    "Text-to-image generation",
    "High-resolution AI images",
    "Cinematic and artistic styles",
    "Secure cloud processing",
    "Integrated AI chat image creation"
  ],
  "creator": {
    "@type": "Organization",
    "name": "VirginAI",
    "url": "https://virginai.in"
  }
}
</script>  


<style>
/* Menu Styles */
.menu-container {
  position: fixed;
  top: 20px;
  left: 20px;
  z-index: 1000;
}

.menu-toggle {
  width: 40px;
  height: 40px;
  border-radius: 12px;
  background: linear-gradient(135deg, var(--gold), var(--gold-soft));
  border: none;
  color: #000;
  font-size: 20px;
  font-weight: bold;
  cursor: pointer;
  display: flex;
  align-items: center;
  justify-content: center;
  transition: all 0.3s;
}

.menu-toggle:hover {
  transform: scale(1.05);
}

.menu-dropdown {
  position: absolute;
  top: 50px;
  left: 0;
  background: var(--panel);
  border: 1px solid var(--border);
  border-radius: 12px;
  min-width: 180px;
  display: none;
  overflow: hidden;
  box-shadow: 0 10px 30px rgba(0, 0, 0, 0.5);
}

.menu-item {
  padding: 12px 16px;
  color: var(--text);
  text-decoration: none;
  display: block;
  border-bottom: 1px solid var(--border);
  font-size: 14px;
  transition: all 0.2s;
}

.menu-item:hover {
  background: rgba(201, 164, 74, 0.1);
  color: var(--gold);
  padding-left: 20px;
}

.menu-item:last-child {
  border-bottom: none;
}

:root{
 --bg:#050505;
 --panel:#0c0c0c;
 --border:#1e1e1e;
 --gold:#c9a44a;
 --gold-soft:#9f8740;
 --text:#eaeaea;
 --muted:#888;
 --accent:#00ffd5;
}

*{box-sizing:border-box}


body{
 margin:0;
 min-height:100vh;
 background:var(--bg);
 font-family:Inter,Segoe UI,sans-serif;
 color:var(--text);
 display:flex;
 justify-content:center;
 overflow-y:auto; /* ‚úÖ allow full page scroll */
}  

.app{
 width:100%;
 max-width:720px;
 min-height:100vh;
 display:flex;
 flex-direction:column;
 padding:16px;
}

/* ===== HEADER ===== */
header{ text-align:center; margin-bottom:10px; }
header h1{ margin:0; font-size:1.8rem; letter-spacing:2px; color:var(--gold); }
header p{ margin:4px 0 0; font-size:13px; color:var(--muted); }

/* ===== CHAT AREA ===== */
#chat{
  flex: 1;
  overflow-y: auto;
  padding: 14px;
  background: var(--panel);
  border:1px solid var(--border);
  border-radius:16px;

  /* üëá Reserve space for fixed footer */
  margin-bottom: 50px; 
}


/* ===== MESSAGE BUBBLES ===== */
.msg{
 max-width:85%;
 margin:12px 0;
 padding:12px 14px;
 border-radius:14px;
 line-height:1.6;
 white-space:pre-wrap;
 word-break:break-word;
 font-size: 15px;
}

.user{
 margin-left:auto;
 background:#121212;
 border:1px solid #2a2a2a;
}

.ai{
 background:#050505; 
 border:1px solid rgba(0,255,213,.15);
 color:#dffff8;
 font-family:Consolas,monospace;
 display: flex;
 flex-direction: column;
 gap: 8px;
}

.ai-header {
 display: flex;
 align-items: center;
 gap: 10px;
 margin-bottom: 4px;
 border-bottom: 1px solid rgba(201,164,74,.15);
 padding-bottom: 8px;
}

.ai-logo {
 width: 26px;
 height: 26px;
 border-radius: 50%;
 border: 1.5px solid var(--gold);
 object-fit: cover;
 background: #000;
}

.ai-name {
 font-size: 12px;
 color: var(--gold);
 font-weight: bold;
 text-transform: uppercase;
 letter-spacing: 1px;
}

.ai-thinking {
  display: inline-flex;
  align-items: center;
  gap: 6px;
  font-size: 15px;
  color: #c9a44a;
}

.ai-thinking span {
  width: 6px;
  height: 6px;
  background: #c9a44a;
  border-radius: 50%;
  animation: blink 1.4s infinite both;
}

.ai-thinking span:nth-child(2) { animation-delay: 0.2s; }
.ai-thinking span:nth-child(3) { animation-delay: 0.4s; }

@keyframes blink {
  0% { opacity: .2; }
  20% { opacity: 1; }
  100% { opacity: .2; }
}  
  
  
 
.ai-content { min-height: 20px; }
.ai-content img {
  cursor: zoom-in;
}  

.ai-content img {
  max-width: 100%;
  border-radius: 12px;
  margin-top: 8px;
  border: 1px solid var(--border);
}  


.download-btn {
  align-self: flex-end;
  display: inline-flex;
  align-items: center;
  gap: 6px;

  margin-top: 8px;
  padding: 6px 10px;

  border-radius: 999px;
  border: 1px solid rgba(201, 164, 74, 0.45);

  background: linear-gradient(
    135deg,
    rgba(201, 164, 74, 0.95),
    rgba(159, 135, 64, 0.95)
  );

  color: #000;
  font-size: 12px;
  font-weight: 600;

  cursor: pointer;
  user-select: none;
  transition: all 0.2s ease;
}

.download-btn:hover {
  transform: translateY(-1px);
  box-shadow: 0 6px 18px rgba(201, 164, 74, 0.35);
}

.download-btn:active {
  transform: scale(0.95);
  box-shadow: none;
}  



.loader {
  display: flex;
  gap: 6px;
}

.loader span {
  width: 8px;
  height: 8px;
  background: #c9a44a;
  border-radius: 50%;
  animation: blink 1.4s infinite both;
}

.loader span:nth-child(2){animation-delay:.2s}
.loader span:nth-child(3){animation-delay:.4s}


/* ===== INTELLIGENCE CLASSES SELECTOR ===== */
.mode-selector {
  display: flex;
  gap: 8px;
  margin-top: 12px;
  justify-content: center;
}





.m-btn {
  flex: 1;
  padding: 10px 5px;
  border-radius: 12px;
  border: 1px solid var(--border);
  background: #0a0a0a;
  color: var(--muted);
  cursor: pointer;
  font-size: 12px;
  font-weight: bold;
  text-transform: uppercase;
  transition: all 0.3s ease;
  text-align: center;
}

/* Default Glow for smart */

.m-btn.active[data-mode="image"] {  
  color: #ff6fff;  
  border-color: #ff6fff;  
  box-shadow: 0 0 18px rgba(255, 111, 255, 0.35);  
}     
.m-btn.active[data-mode="smart"] {
  color: #fff;
  border-color: #ffffff;
  background: #1a1a1a;
  box-shadow: 0 0 15px rgba(255, 255, 255, 0.2);
}
.m-btn.active[data-mode="internet"] {
  color: #1F51FF;
  border-color:#1F51FF;
  box-shadow: 0 0 15px rgba(255, 255, 255, 0.2);
}
.m-btn.active[data-mode="think"] {
  color: var(--accent);
  border-color: var(--accent);
  box-shadow: 0 0 15px rgba(0, 255, 213, 0.3);
}
.m-btn.active[data-mode="flash"] {
  color: var(--gold);
  border-color: var(--gold);
  box-shadow: 0 0 15px rgba(201, 164, 74, 0.3);
}

/* ===== CHAT FOOTER (MODE + INPUT FIXED) ===== */
/* ===== CHAT FOOTER (MODE + INPUT FIXED) ===== */

.chat-footer {
  position: sticky;
  bottom: 0;
  width: 100%;
  max-width: 720px;
  margin: auto;

  background: var(--bg);
  padding: 8px 12px 12px;
  border-top: 1px solid var(--border);
  z-index: 10;
}




/* ===== INPUT BAR ===== */
/* ===== INPUT BAR ===== */
.input-bar {
  position: relative;
  margin-top: 8px;
}

/* Textarea */
.input-bar textarea {
  width: 100%;
  min-height: 48px;
  max-height: 160px;
  resize: none;

  padding: 14px 56px;          /* space for icons */
  padding-left: 56px;          /* left + button */
  padding-right: 56px;         /* right send button */

  border-radius: 16px;
  border: 1px solid var(--border);
  background: #020202;
  color: var(--text);
  font-size: 15px;
  outline: none;

  overflow-y: auto;
}

/* Common icon button */
.icon-btn {
  position: absolute;
  bottom: 8px;
  width: 40px;
  height: 40px;
  border-radius: 50%;
  border: none;
  cursor: pointer;

  display: flex;
  align-items: center;
  justify-content: center;

  font-size: 18px;
}

/* LEFT (+) */
.icon-btn.attach {
  left: 8px;
  background: #111;
  color: var(--gold);
}

/* RIGHT (send arrow) */
.icon-btn.send {
  right: 8px;
  background: linear-gradient(135deg, var(--gold), var(--gold-soft));
  color: #000;
  font-size: 20px;
  font-weight: bold;
}

.icon-btn:active {
  transform: scale(0.95);
}


.attach-menu {
  position: absolute;
  bottom: 56px;
  left: 8px;
  background: #0b0b0b;
  border: 1px solid var(--border);
  border-radius: 12px;
  padding: 6px;
  display: none;
  flex-direction: column;
  gap: 4px;
  z-index: 20;
}

.attach-menu button {
  background: transparent;
  border: none;
  color: var(--text);
  padding: 8px 12px;
  text-align: left;
  cursor: pointer;
  border-radius: 8px;
  font-size: 14px;
}

.attach-menu button:hover {
  background: rgba(201,164,74,0.12);
  color: var(--gold);
}










/* ===== FOOTER ===== */
footer{ margin-top:10px; text-align:center; font-size:11px; color:var(--muted); }
footer a{ color:var(--gold); text-decoration:none; margin:0 4px; }

/* ===== SEO HIDDEN ===== */
.seo-hidden { position:absolute; left:-9999px; width:1px; height:1px; overflow:hidden; }

@media(max-width:480px){
 .app{padding:10px}
 .msg{max-width:92%}
 header h1{font-size:1.5rem}
 .menu-container { top: 10px; left: 10px; }
 .menu-toggle { width: 36px; height: 36px; font-size: 18px; }
 .mode-selector { gap: 4px; }
 .m-btn { font-size: 10px; padding: 8px 2px; }
}
</style>
</head>

<body>
<div class="menu-container">
  <button class="menu-toggle" onclick="toggleMenu()">‚ò∞</button>
  <div class="menu-dropdown" id="menuDropdown">
    <a href="upcomingmodel.html" class="menu-item">Upcoming Model AI</a>
    <a href="developer.html" class="menu-item">Developer</a>
    <a href="offers.html" class="menu-item">Offers</a>
   <a href="login.html" class="menu-item">Login</a>
  </div>
</div>

<div class="app">

<div class="seo-hidden" aria-hidden="true">
  <h1>VirginAI ‚Äì Advanced Intelligent AI Chat Assistant</h1>

  <p>
    <strong>VirginAI</strong> is an independently developed
    <strong>AI-powered chat assistant</strong> focused on
    <strong>education</strong>, <strong>research</strong>,
    <strong>problem-solving</strong>, and <strong>productivity</strong>.
    The platform is designed to deliver fast, accurate, and reliable
    AI-generated responses through a secure web interface.
  </p>

  <p>
    Proudly developed in <strong>India</strong>, VirginAI is a digital
    artificial intelligence platform built for global users.
  </p>

  <h2>Founders & Creators</h2>
  <p>
    VirginAI was <strong>founded, designed, and developed</strong> by
    <strong>Raj Verma</strong> and <strong>Kalash Verma</strong>.
    The project is built as an independent initiative with a focus on
    transparency, performance, and user trust.
  </p>

  <h2>Core Technology</h2>
  <p>
    VirginAI is powered by a modern, multi-model artificial intelligence
    architecture combining advanced large language models and
    high-quality image generation systems.
    This distributed approach ensures high availability, low latency,
    and reliable performance even under heavy user load.
  </p>

  <h2>AI Image Generation</h2>
  <p>
    VirginAI includes an advanced
    <strong>AI image generation feature</strong> that allows users to
    create high-quality images from text prompts.
  </p>

  <p>
    Users can generate images in multiple styles such as
    <strong>realistic</strong>, <strong>cinematic</strong>,
    <strong>artistic</strong>, and <strong>futuristic</strong>
    using state-of-the-art diffusion models.
  </p>

  <p>
    The image generation system is powered by secure cloud-based
    infrastructure and is optimized for speed, privacy, and reliability.
  </p>

  <ul>
    <li>Text-to-image AI generation</li>
    <li>High-resolution outputs</li>
    <li>Fast response time</li>
    <li>No image data stored on servers</li>
    <li>Integrated directly into chat interface</li>
  </ul>

</div>


<header>
  <h1>VirginAI</h1>
  <p>Proudly made in India üáÆüá≥ ¬∑ End-to-end encrypted</p>
</header>

<div id="chat"></div>



<div class="chat-footer">
  <div class="mode-selector">
    <div class="m-btn" data-mode="image">Image</div>
    <div class="m-btn active" data-mode="smart">Smart</div>
    <div class="m-btn" data-mode="internet">Internet</div>
    <div class="m-btn" data-mode="think">Think</div>
    <div class="m-btn" data-mode="flash">Flash</div>
  </div>

  <div class="input-bar">
      <!-- Attach button -->
    <!--<button class="icon-btn attach" onclick="openPicker()">Ôºã</button> -->
    <button class="icon-btn attach" onclick="openPicker(event)">Ôºã</button>

   <!-- Text input -->
    <textarea id="q" placeholder="Ask anything..."></textarea>

   <!-- Send button (inside textarea area) -->
    <button class="icon-btn send" onclick="ask()">
      <svg width="18" height="18" viewBox="0 0 24 24" fill="none">
      <path d="M12 4L19 11H14V20H10V11H5L12 4Z" fill="#000"/>
      </svg>
    </button>

   <!-- Hidden file input -->
    <input type="file" id="fileInput"
           accept="image/*,.pdf,.txt,.py,.html,.css"
           hidden>
  </div>
  <div class="attach-menu" id="attachMenu">
  <button onclick="pickCamera()">üì∑ Camera</button>
  <button onclick="pickGallery()">üñºÔ∏è Photos</button>
  <button onclick="pickFile()">üìÑ Files</button>
</div>
</div>



<footer>
 <a href="/about.html">About</a> ¬∑ <a href="/developer.html">Developer</a> ¬∑ <a href="/help.html">Help</a> ¬∑ <a href="/faq.html">FAQ</a> ¬∑ <a href="/contact.html">Contact</a> ¬∑ <a href="/privacy.html">Privacy</a> ¬∑ <a href="/terms.html">Terms</a>
 <br><br>
 ¬© 2025 VirginAI. All rights reserved.
</footer>
</div>



<div id="imgViewer" style="
  display:none;
  position:fixed;
  inset:0;
  background:rgba(0,0,0,.9);
  z-index:9999;
  justify-content:center;
  align-items:center;
">
  <img id="viewerImg" style="
    max-width:95%;
    max-height:95%;
    border-radius:14px;
  ">
</div>  

<script>
let currentMode = "smart";

// Toggle between Intelligence Classes
document.querySelectorAll('.m-btn').forEach(btn => {
  btn.onclick = () => {
    document.querySelectorAll('.m-btn').forEach(b => b.classList.remove('active'));
    btn.classList.add('active');
    currentMode = btn.getAttribute('data-mode');
  };
});

// Menu toggle function
function toggleMenu() {
  const menu = document.getElementById('menuDropdown');
  menu.style.display = menu.style.display === 'block' ? 'none' : 'block';
}

// Close menu when clicking outside
document.addEventListener('click', function(event) {
  const menu = document.getElementById('menuDropdown');
  const toggle = document.querySelector('.menu-toggle');
  if (menu && !menu.contains(event.target) && !toggle.contains(event.target)) {
    menu.style.display = 'none';
  }
});

const chat = document.getElementById("chat");
const q = document.getElementById("q");


let currentImageBlobUrl = null;


document.addEventListener("click", e => {
  if (e.target.tagName === "IMG" && e.target.closest(".ai-content")) {
    const viewer = document.getElementById("imgViewer");
    const img = document.getElementById("viewerImg");

    currentImageBlobUrl = e.target.src;
    img.src = currentImageBlobUrl;
    viewer.style.display = "flex";

    // üî• push state when viewer opens
    history.pushState({ imageViewer: true }, "");
  }
});  


function downloadImage(blobUrl) {
  if (!blobUrl || !blobUrl.startsWith("blob:")) return;
  const a = document.createElement("a");
  a.href = blobUrl;
  a.download = `VirginAI_Image_${Date.now()}.png`;
  document.body.appendChild(a);
  a.click();
  document.body.removeChild(a);
}  


function add(text, cls, isImage = false) {
  const d = document.createElement("div");
  d.className = "msg " + cls;

  if (cls === "ai") {
    if (isImage) {
      d.innerHTML = `
        <div class="ai-header">
          <img src="/favicon-32x32.png" class="ai-logo" alt="VirginAI">
          <span class="ai-name">VirginAI ‚Ä¢ IMAGE</span>
        </div>
        <div class="ai-content">
          <img src="${text}" alt="AI generated image by VirginAI">
          <button class="download-btn" onclick="downloadImage('${text}')" title="Download image">
           <svg width="16" height="16" viewBox="0 0 24 24" fill="none">
           <path d="M12 3V14" stroke="#000" stroke-width="2" stroke-linecap="round"/>
          <path d="M7 10L12 15L17 10" stroke="#000" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
          <path d="M5 21H19" stroke="#000" stroke-width="2" stroke-linecap="round"/>
          </svg>
          </button>
      
        </div>
      `;
    } else {
      d.innerHTML = `
        <div class="ai-header">
          <img src="/favicon-32x32.png" class="ai-logo" alt="VirginAI">
          <span class="ai-name">VirginAI ‚Ä¢ ${currentMode.toUpperCase()}</span>
        </div>
        <div class="ai-content">${text}</div>
      `;
    }
  } else {
    d.innerHTML = text;
  }

  chat.appendChild(d);
  chat.scrollTop = chat.scrollHeight;
  return d;
}

function typeMatrix(el, text) {
  const contentEl = el.querySelector(".ai-content");
  let i = 0;
  contentEl.textContent = "";
  const speed = 14;
  const timer = setInterval(() => {
    contentEl.textContent += text[i++] || "";
    chat.scrollTop = chat.scrollHeight;
    if (i >= text.length) {
      clearInterval(timer);
      chat.scrollTop = chat.scrollHeight;
    }
  }, speed);
}


async function ask() {
  const text = q.value.trim();
  if (!text) return;

  add(text, "user");
  q.value = "";

  // üñºÔ∏è IMAGE MODE
  if (currentMode === "image") {
    //const aiBubble = add(imageLoaderHTML(), "ai");
    const aiBubble = add(
  `<div class="loader"><span></span><span></span><span></span></div>`,
  "ai"
);

    try {
      const r = await fetch("/generate-image", {
        method: "POST",
        headers: { "Content-Type": "application/json" },
        body: JSON.stringify({ prompt: text })
      });

      if (!r.ok) throw new Error("Image failed");

      const blob = await r.blob();
      const url = URL.createObjectURL(blob);

      aiBubble.remove();
      add(url, "ai", true); // ‚úÖ show image

    } catch {
      aiBubble.querySelector(".ai-content").innerHTML =
        "‚ö†Ô∏è Image service unavailable";
    }
    return;
  }

  // üí¨ NORMAL CHAT + FILE LOGIC (unchanged)
  const fileInput = document.getElementById("fileInput");
  const file = fileInput.files[0];

  const aiBubble = add(
  `<div class="ai-thinking">
     Thinking
     <span></span>
     <span></span>
     <span></span>
   </div>`,
  "ai"
);

  try {
    let r;

    if (file) {
      const form = new FormData();
      form.append("file", file);
      form.append("question", text || "Explain this");

      r = await fetch("/upload", {
        method: "POST",
        body: form
      });

      fileInput.value = "";
    } else {
      r = await fetch("/ask", {
        method: "POST",
        headers: { "Content-Type": "application/json" },
        body: JSON.stringify({
          question: text,
          mode: currentMode
        })
      });
    }

    const d = await r.json();
    typeMatrix(aiBubble, d.answer || "No response.");

  } catch {
    typeMatrix(aiBubble, "‚ö†Ô∏è Service unavailable.");
  }
}


/* SMART KEYBOARD LOGIC FOR ANDROID & DESKTOP */
q.addEventListener("keydown", e => {
  // Mobile check: Most mobile browsers use touch.
  const isMobile = 'ontouchstart' in window || navigator.maxTouchPoints > 0;

  if (e.key === "Enter") {
    if (isMobile) {
      // On Android/Mobile: Allow Enter key to create a NEW LINE.
      // User must click "‚û§" button to send.
      return; 
    } else {
      // On Desktop: Enter = SEND, Shift+Enter = NEW LINE.
      if (!e.shiftKey) {
        e.preventDefault();
        ask();
      }
    }
  }
});



q.addEventListener("input", function() {
  this.style.height = "auto";
  this.style.height = (this.scrollHeight) + "px";
});

window.addEventListener("beforeunload", () => {
  if (currentImageBlobUrl?.startsWith("blob:")) {
    URL.revokeObjectURL(currentImageBlobUrl);
  }
});  


/* Mobile Protection */
let backOnce = false;
history.pushState(null, "", location.href);

window.onpopstate = () => {
  const viewer = document.getElementById("imgViewer");

  // üñºÔ∏è If image viewer is open ‚Üí CLOSE ONLY
  if (viewer.style.display === "flex") {
    viewer.style.display = "none";
    return; // ‚ùó DO NOT revoke blob here
  }

  // üö™ App exit protection
  if (!backOnce) {
    backOnce = true;
    alert("Press back again to exit VirginAI");
    history.pushState(null, "", location.href);
    setTimeout(() => backOnce = false, 2000);
  }
};

function openPicker(e) {
  if (e) e.stopPropagation();
  const menu = document.getElementById("attachMenu");
  menu.style.display = menu.style.display === "flex" ? "none" : "flex";
}

document.getElementById("fileInput").addEventListener("change", function () {
  const file = this.files[0];
  if (!file) return;

  // OPTIONAL: read text/code files into textarea
  if (
    file.type.startsWith("text") ||
    file.name.endsWith(".py") ||
    file.name.endsWith(".html") ||
    file.name.endsWith(".css")
  ) {
    const reader = new FileReader();
    reader.onload = () => {
      q.value += `\n\n--- FILE: ${file.name} ---\n${reader.result}\n`;
    };
    reader.readAsText(file);
  }

  // Image hint (non-chat)
  if (file.type.startsWith("image")) {
    q.value += `\n[Image attached: ${file.name}]`;
  }
});



//new add //
function pickCamera() {
  openFile("image/*", "environment");
}

function pickGallery() {
  openFile("image/*");
}

function pickFile() {
  openFile(".pdf,.txt,.py,.html,.css");
}

function openFile(accept, capture = null) {
  const input = document.getElementById("fileInput");
  input.accept = accept;

  if (capture) {
    input.setAttribute("capture", capture);
  } else {
    input.removeAttribute("capture");
  }

  document.getElementById("attachMenu").style.display = "none";
  input.click();
}


window.onload = () => q.focus();

</script>

<script type="module">
import { auth } from "./firebase.js";
import {
  onAuthStateChanged,
  signOut
} from "https://www.gstatic.com/firebasejs/10.7.1/firebase-auth.js";

/* ELEMENTS */
const menuDropdown = document.getElementById("menuDropdown");

/* AUTH STATE */
onAuthStateChanged(auth, (user) => {
  // Clear auth items only (avoid duplicates)
  menuDropdown.querySelectorAll(".auth-item").forEach(e => e.remove());

  if (user) {
    // Logged in ‚Üí show Profile & Logout
    menuDropdown.insertAdjacentHTML("beforeend", `
      <a href="profile.html" class="menu-item auth-item">
        üë§ ${user.displayName || "Profile"}
      </a>
      <a href="#" id="logoutBtn" class="menu-item auth-item">
        üö™ Logout
      </a>
    `);

    document.getElementById("logoutBtn").onclick = async () => {
      await signOut(auth);
      location.reload();
    };

  } else {
    // Guest ‚Üí show Login
    menuDropdown.insertAdjacentHTML("beforeend", `
      <a href="login.html" class="menu-item auth-item">
        üîê Login
      </a>
    `);
  }
});
</script>
</body>
</html>